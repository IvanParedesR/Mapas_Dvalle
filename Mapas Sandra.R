#### 6.2 Mapas de mexico
#Para insalar es necesario instalar primero el paquete devtools y units, aquí es necesario quitar todas los "#"
# sin modificar la tabla.

#if (!require("devtools")) {
#  install.packages("devtools")
#}
#devtools::install_github("diegovalle/mxmaps")

#install.packages("units") 
#install.packages("mxmaps")

library("mxmaps")

#cargamos la base que nos interesa
library(readxl)
Tasas_de_incidencia_delictiva_marzo_2019 <- read_excel("C:/Users/sandra.razo/Desktop/Coordinación/Seguridad/2019/Marzo/Tasas de incidencia delictiva marzo 2019.xlsx",
                                                     sheet = "Municipios", range = "A1:W2458")
View(Tasas_de_incidencia_delictiva_marzo_2019)
View(df_mxmunicipio)

df_mxmunicipio1 <- merge(df_mxmunicipio,Tasas_de_incidencia_delictiva_marzo_2019, by.x = c("region"), by.y = c("region_a"), all = TRUE)

View(df_mxmunicipio1)

library(RColorBrewer)
library(scales)
library(crayon)
library(colorspace)
library(viridis)
library(ggplot2)
library(geojsonio)
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
library(ggrepel)

data("mxstate.topoJSON")
data("df_mxstate")

tmpdir <- tempdir()
# have to use RJSONIO or else the topojson isn't valid
write(RJSONIO::toJSON(mxstate.topoJSON), file.path(tmpdir, "state.topojson"))
states <- topojson_read(file.path(tmpdir, "state.topojson"))
## OGR data source with driver: GeoJSON 
## Source: "/tmp/RtmplGZzS8/state.topojson", layer: "state"
## with 32 features
## It has 1 fields

# remove bad polygons
states <- gBuffer(states, byid=TRUE, width=0)

# make sure the coordinates of the labels are in the correct order
df_mxstate <- cbind(df_mxstate, 
                    data.frame(lon = coordinates(states[match(df_mxstate$region, states$id),])[,1],
                               lat = coordinates(states[match(df_mxstate$region, states$id),])[,2]))

df_mxstate$group <- df_mxstate$state_abbr

df_mxstate$state_abbr[3]="    "
df_mxstate$state_abbr[31]="  "
df_mxstate$state_abbr[7]="    "
df_mxstate$state_abbr[14]="   "
df_mxstate$state_abbr[1]="   "
df_mxstate$state_abbr[2]="   "
df_mxstate$state_abbr[3]="   "
df_mxstate$state_abbr[4]="   "
df_mxstate$state_abbr[5]="   "
df_mxstate$state_abbr[8]="     "
df_mxstate$state_abbr[10]="   "
df_mxstate$state_abbr[18]="   "
df_mxstate$state_abbr[19]="  "
df_mxstate$state_abbr[11]="   "
df_mxstate$state_abbr[22]="   "
df_mxstate$state_abbr[23]="    "
df_mxstate$state_abbr[25]="   "
df_mxstate$state_abbr[26]="   "
df_mxstate$state_abbr[27]=" "
df_mxstate$state_abbr[28]="   "
df_mxstate$state_abbr[32]="   "
df_mxstate$state_abbr[13]="   "
df_mxstate$state_abbr[24]="   "
df_mxstate$state_abbr[30]="   "


##mapas de los municipios con base que nos interesa
#Tasa de extorsión


df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Extorsión` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Extorsión") +
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Extorsión",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)

#tasa Homicidio doloso

df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Homicidio doloso` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Homicidio doloso") +
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Homicidio Doloso",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)


#tasa robo a casa habitación

df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Robo a casa habitación` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Robo a casa habitación")+
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Robo a casa habitación",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)


#tasa robo a transeunte en vía pública

df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Robo a transeúnte en vía pública` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Robo a transeúnte en vía pública")+
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Robo a transeúnte en vía pública",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)


#tasa de robo a vehiculo automotor

df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Robo de vehículo automotor` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Robo de vehículo automotor") +
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Robo de vehículo automotor",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)


#tasa secuestro

df_mxmunicipio1$value <- df_mxmunicipio1$`Tasa Secuestro` # se crea una nueva variable

mxmunicipio_choropleth(df_mxmunicipio1, 
                       num_colors = 1,
                       zoom = c(12002,12003,12004,12005,12006,12007,12008,12009,12010,12015,12016,12017,12019,12020,12022,12024,12026,12027,12031,12032,12033,12034,12035,12037,12040,12042,12045,12047,12049,12050,12054,12055,12058,12059,12060,12064,12065,12066,12067,12068,12069,12070,12073,12074,12075,14049,14056,14069,15004,15007,15008,15015,15021,15032,15034,15040,15041,15049,15050,15052,15063,15066,15068,15077,15078,15080,15082,15086,15088,15094,15097,15105,15107,15110,15111,15113,15114,15116,15117,15119,15123,16005,16006,16007,16009,16010,16012,16013,16019,16021,16029,16033,16034,16035,16038,16046,16047,16049,16052,16055,16057,16058,16059,16061,16064,16065,16068,16075,16077,16079,16081,16082,16083,16087,16089,16090,16091,16092,16095,16097,16098,16099,16101,16102,16111,16112,17001,17002,17003,17004,17005,17006,17007,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17024,17025,17026,17027,17028,17029,17030,17031,17032,17033,20004,20011,20022,20032,20034,20039,20055,20065,20081,20089,20093,20099,20105,20106,20152,20160,20164,20165,20181,20183,20186,20199,20208,20210,20221,20230,20237,20239,20240,20242,20245,20251,20259,20261,20286,20290,20317,20321,20339,20340,20341,20346,20348,20352,20373,20376,20379,20381,20397,20400,20405,20408,20423,20455,20456,20459,20461,20462,20476,20480,20484,20486,20499,20501,20520,20521,20524,20528,20529,20532,20536,20537,20540,20547,20549,20556,20567,20568,21001,21003,21004,21005,21007,21009,21011,21012,21015,21018,21019,21020,21021,21022,21024,21026,21031,21032,21033,21034,21037,21038,21040,21041,21042,21044,21045,21047,21048,21051,21052,21055,21056,21059,21060,21062,21065,21066,21067,21069,21070,21073,21074,21079,21081,21082,21085,21087,21090,21092,21093,21094,21095,21096,21097,21098,21102,21104,21105,21106,21108,21110,21112,21113,21114,21115,21117,21118,21119,21121,21122,21125,21126,21127,21128,21130,21131,21132,21133,21134,21135,21136,21137,21138,21139,21140,21141,21142,21143,21144,21146,21147,21148,21150,21151,21152,21153,21154,21155,21157,21159,21160,21163,21164,21165,21166,21168,21169,21170,21171,21175,21176,21179,21180,21181,21182,21185,21188,21189,21190,21191,21193,21196,21198,21201,21203,21206,29001,29002,29003,29004,29005,29007,29008,29009,29010,29011,29012,29013,29014,29015,29016,29017,29018,29019,29022,29023,29024,29025,29026,29027,29028,29029,29030,29031,29032,29033,29034,29035,29036,29037,29038,29039,29040,29041,29042,29043,29044,29046,29047,29048,29049,29050,29051,29052,29053,29054,29055,29056,29057,29058,29059,29060),
                       legend = "Tasa Secuestro")+
  scale_fill_continuous(low = "#f9f8d4", high = "#ff1400",name="Tasa Secuestro",
                        space = "Lab", guide = "colourbar") +
  geom_text_repel(data = df_mxstate, aes(lon, lat, label = state_abbr), size = 3,
                  box.padding = unit(0.1, 'lines'), force = 0.1)


